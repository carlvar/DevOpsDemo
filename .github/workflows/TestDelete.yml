name: Test GitHub Actions for deleting
run-name: ${{ github.actor }} is testing out GitHub Actions ðŸš€
on: [workflow_dispatch]
jobs:
  BeerDemo-DeployToTest:
    runs-on: ubuntu-latest
    steps:
    - name: Who Am I
      uses: microsoft/powerplatform-actions/who-am-i@v0
      with:
        environment-url: ${{ vars.PIPELINES_ENV_DEV_URL }}
        app-id: ${{ vars.PIPELINES_APP_ID }}
        client-secret: ${{ secrets.PIPELINES_SECRET }}
        tenant-id:  ${{ vars.PIPELINES_TENANT_ID }}
      
    - name: Export Solution
      uses: microsoft/powerplatform-actions/export-solution@v0
      with:
        environment-url: ${{ vars.PIPELINES_ENV_DEV_URL }}
        app-id: ${{ vars.PIPELINES_APP_ID }}
        client-secret: ${{ secrets.PIPELINES_SECRET }}
        tenant-id: ${{ vars.PIPELINES_TENANT_ID }}
        solution-name: BeerSolutionGitHub
        solution-output-file: './solution/BeerSolutionGitHub.zip'
        managed: false
      

    - name: Unpack Solution
      uses: microsoft/powerplatform-actions/unpack-solution@v0
      with:
        solution-file: './solution/BeerSolutionGitHub.zip'
        solution-folder: './src'
        solution-type: 'Unmanaged'
        overwrite-files: true

#    - name: Publish Solution
#      uses: microsoft/powerplatform-actions/publish-solution@v0
#      with:
#        environment-url: 'https://myenv.crm.dynamics.com'
#        user-name: 'me@myenv.onmicrosoft.com'
#        password-secret: ${{ secrets.MYPASSWORD }}
#
#    - name: Prepare solution changes for check-in into source control
#      uses: microsoft/powerplatform-actions/branch-solution@v0
#      with:
#        solution-folder: 'out/solutions/solution one'
#        solution-target-folder: 'src/solutions/solution1'
#        token: ${{ secrets.GITHUB_TOKEN }}
#
